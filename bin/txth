#!/bin/bash

# /usr/bin/gnome-terminal -e "/bin/nano ~/txt/'$(/usr/bin/tac ~/.txt_history | dmenu -l 15 -i)'"

chosen="$(ls -A ~/txt/ | grep -Ev '(\.swp$|\.save|~)$' | tac ~/.txt_history - | awk '!a[$0]++' | dmenu -l 15 -i -fn 'Noto Sans Mono:size=12')"

# only use if there is something in the string
if [ ! -z "$chosen" -a "$chosen" != " " ]; then
        # make sure there is a history file:
        touch ~/.txt_history

        # is it a dupe?
        if [ "$chosen" != "$(cat ~/.txt_history | tail -1)" ]; then
                # add to history because it is not a dupe
                echo "$chosen" >> ~/.txt_history
        fi

	echo ~/txt/'$chosen'
	urxvt -e bash -c "source ~/.bashrc && vim ~/txt/\"$chosen\""
fi
